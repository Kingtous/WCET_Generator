echo 'WCET_Generater_V2.3'

command -v python3 >/dev/null 2>&1 || { echo -e >&2 "I require python3 but it's can't be found. \nTry source /etc/profile or .bash_profile?\nAborted."; exit 1; }
command -v sweet >/dev/null 2>&1 || { echo -e >&2 "I require SWEET but it's can't be found. \nTry source /etc/profile or .bash_profile?\nAborted."; exit 1; }


basepath=$(cd `dirname $0`; pwd)

args=""

while getopts "i:w:s:th" opt;
do
    case $opt in
        i)
			if [ ! -f $OPTARG ]; then
				echo "-i Input Invalid."
				echo "Aborted."
				exit 0
			else
				file=`basename $OPTARG`
            	args="$args -i $(cd `dirname $OPTARG`; pwd)/$file"
			fi
			;;
        w)
			if [ -f $OPTARG ]; then
				echo "-w Input Invalid."
				echo "Aborted."
				exit 0
			fi
            file=`basename $OPTARG`
            args="$args -w $(cd `dirname $OPTARG`; pwd)/$file"
            ;;
        s)
			if [ -f $OPTARG ]; then
				echo "-s Input Invalid."
				echo "Aborted."
				exit 0
			fi
            file=`basename $OPTARG`
            args="$args -s $(cd `dirname $OPTARG`; pwd)/$file"
            ;;
        t)
			if [ -f $OPTARG ]; then
				echo "-t Input Invalid."
				echo "Aborted."
				exit 0
			fi
            file=`basename $OPTARG`
            args="$args -t $(cd `dirname $OPTARG`; pwd)/$file"
            ;;
        h)
            args="-h"
            break
            ;;
        \?)
            echo "Invalid Operator."
            echo "Aborted."
            exit 0
            ;;
    esac
done

if [ -n "$args" ]; then
	echo "/usr/bin/python3 $basepath/src/main.py "$args
	#/usr/bin/python3 $basepath/src/main.py $args
else
	echo "Please Import the file u'd like to analyze."
fi
